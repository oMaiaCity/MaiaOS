{
	"$schema": "째Maia/schema/meta",
	"$id": "째Maia/schema/action",
	"title": "째Maia/schema/action",
	"description": "Action (tool invocation, context update, data mapping, or setEventPayload for deferred transitions)",
	"cotype": "comap",
	"indexing": true,
	"oneOf": [
		{
			"type": "object",
			"properties": {
				"actor": {
					"type": "string",
					"description": "Target actor $id (e.g. 째Maia/actor/db) - id-based registry lookup"
				},
				"sendToActor": {
					"type": "string",
					"description": "Target actor $id - same as actor, id-based only"
				},
				"payload": {
					"description": "Event payload (expressions evaluated before delivery)",
					"type": "object",
					"additionalProperties": true
				}
			},
			"anyOf": [{ "required": ["actor"] }, { "required": ["sendToActor"] }]
		},
		{
			"type": "object",
			"properties": {
				"updateContext": {
					"type": "object",
					"description": "Context updates (infrastructure, not a tool)",
					"additionalProperties": true
				}
			},
			"required": ["updateContext"]
		},
		{
			"type": "object",
			"properties": {
				"mapData": {
					"type": "object",
					"description": "Map operations engine configs to context keys (universal API)",
					"additionalProperties": {
						"type": "object",
						"description": "Operations engine config (op, schema, filter, key, keys, etc.)",
						"properties": {
							"op": {
								"type": "string",
								"description": "Operation type (read, create, update, delete, schema, resolve, etc.)",
								"default": "read"
							}
						},
						"additionalProperties": true
					}
				}
			},
			"required": ["mapData"]
		},
		{
			"type": "object",
			"properties": {
				"setEventPayload": {
					"type": "object",
					"description": "Set event payload for next entry (deferred message handling)",
					"additionalProperties": true
				}
			},
			"required": ["setEventPayload"]
		}
	]
}
