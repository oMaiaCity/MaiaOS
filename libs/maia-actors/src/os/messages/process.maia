{
	"$schema": "째Maia/schema/process",
	"$id": "째Maia/actor/os/messages/process",
	"@label": "@maia/actor/os/messages/process",
	"handlers": {
		"SEND_MESSAGE": [
			{
				"op": {
					"create": {
						"schema": "째Maia/schema/data/chat",
						"data": {
							"role": "user",
							"content": "$$inputText",
							"displayName": "me"
						}
					}
				}
			},
			{
				"ask": {
					"target": "째Maia/actor/os/ai",
					"type": "CHAT",
					"payload": {
						"replyTo": "$$source",
						"model": "qwen/qwen3-30b-a3b-instruct-2507",
						"temperature": 1,
						"context": {
							"$concat": [
								[
									{
										"role": "system",
										"content": "You are Maia. Be helpful, technical, and concise. Never use emoticons in your responses. When you write to the paper via updatePaperContent and it succeeds, respond with only a short 1-2 sentence confirmation (e.g. confirm briefly like: I wrote that to the paper). Do NOT repeat or paste the full content in the chat - it is already visible on the paper."
									}
								],
								{
									"$map": {
										"array": "$conversations",
										"as": "msg",
										"return": {
											"role": "$$msg.role",
											"content": "$$msg.content"
										}
									}
								},
								[
									{
										"role": "user",
										"content": "$$inputText"
									}
								]
							]
						}
					}
				}
			}
		]
	}
}
